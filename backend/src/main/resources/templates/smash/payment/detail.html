<th:block th:replace="~{/layout/basic :: setContent(~{this::content} )}">
  <th:block th:fragment="content">
    <style>
      table.table-bordered {
        border-collapse: collapse;
        width: 100%;
        text-align:center;
        margin-top:3rem;
      }
      thead th{font-weight: bold;background-color: #f5f5f5;}
      table, th, td {border: 1px solid #dee2e6;}
      tbody .status {
        display: flex;
        justify-content: space-around;
        align-items: center;
        flex-direction: column;
        height:100px;
        border: none;
      }
    </style>

    <input type="hidden" id="paymentIdx" th:value="${payment.idx}" />

    <!-- 결제서 상세 페이지 -->
    <h1 style="font-size: 24px; font-weight: bold;">결제 상세 페이지</h1>
    <hr>
    
    <table class="table table-bordered">
      <thead style="height: 40px;">
        <tr>
          <th scope="col">결제서 번호</th>
          <th scope="col">결제 금액</th>
          <th scope="col">결제 상태</th>
          <th scope="col">결제 방법</th>
          <th scope="col">결제 일시</th>
        </tr>
      </thead>
      <tbody>
        <!-- <tr th:each="payment : ${payments}"> -->
        <tr style="height:100px;">
          <td th:text="${payment?.idx}"></td>
          <td th:text="${payment?.actualPaidPrice} + ' 원'"></td>
          <td class="status">
            <span th:text="${payment?.status}"></span>
            <!-- enum일 경우 문자열로 비교 .name() -->
            <button th:if="${payment?.status.name() == 'paid'}" onclick="canclledPaid()">결제 취소</button>
            <button th:if="${payment?.status.name() == 'canceled'}" disabled>환불 완료</button>
          </td>
          <td th:text="${payment?.payType}"></td>
          <td th:text="${#temporals.format(payment?.paidAt, 'yyyy-MM-dd HH:mm:ss')}"></td>
        </tr>
      </tbody>

      <script th:inline="javascript">
        const paymentIdx = Number(document.getElementById("paymentIdx").value);
        // console.log("결제서 번호:", paymentIdx);
        function canclledPaid() {
          if (confirm("정말로 결제를 취소하시겠습니까?")) {
            axios.post(`/smash/payment/cancel/${paymentIdx}`, {})
            .then(response => {
              alert("결제가 취소되었습니다.");
              location.reload(); // 페이지 새로고침
            })
            .catch(error => {
              console.error("결제 취소 중 오류 발생:", error);
              alert("결제 취소에 실패했습니다.");
            });
          }
        }
      </script>
  </th:block>
</th:block>
