<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
  <header>
  <!-- Bootstrap 4 CSS -->
      <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <!-- icon -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" /> 


   <!-- CSS -->
   <link rel="stylesheet" th:href="@{/request.css}" />


</header>

<th:block th:replace="~{/layout/basic :: setContent(~{this::content} )}">
  <th:block th:fragment="content">    
    <hr>
<!-- 의뢰서 상세 페이지------------------------------------------------------------------------------------------- -->
<div class="request_wrapper">
  <div class="request_header">
    <h3 class="request_title"> [[${dto.title}]]</h3>
    <span class="status_tag">낙찰 완료</span>
  </div>
  <div class="small_box">
  <!-- 이미지 -->
  <div class="attached_image_area" th:if="${not #lists.isEmpty(dto.images)}">
        <div class="attached_image" th:each="image : ${dto.images}" th:if="${image.path != null}">
          <img class="zoomable_image" th:src="@{${image.path}}" alt="첨부 이미지"/>
        </div>
  </div>
  <!-- 이미지 Lightbox (이미지 크게 보기) -->
  <div id="lightbox" class="lightbox" onclick="closeLightbox()">
    <img id="lightbox_img" src="" alt="zoom" />
  </div>

  <div class="request_content_box">
    <div class="xsmall_box"> 
      <div class="hashtags">[[${dto.hashtags}]]</div>

      <div class="description">
        <pre th:text="${dto.content}"></pre>
      </div>     

      <div class="info">      
      <p>사용 지역: [[${dto.useRegion}]]</p>
      <p>사용 예정 날짜: [[${#temporals.format(dto.useDate, 'yyyy.MM.dd')}]]</p>
      </div>
    </div>    

    <div class="created_at">작성날짜: [[${#temporals.format(dto.createdAt, 'yy.MM.dd')}]]</div>
  </div>
  </div>
</div>

  <div class="request_btn_group">
    <button class="btn delete">의뢰서 삭제</button>
    <button class="btn">의뢰서 수정</button>
    <button class="btn">견적서 작성</button>
  </div>
  <hr>

  <!--이미지 lightbox. Js code((이미지 크게 보기) -->
  <script>
  document.addEventListener("DOMContentLoaded", function () {
    const images = document.querySelectorAll(".zoomable_image");
    const lightbox = document.getElementById("lightbox");
    const lightboxImg = document.getElementById("lightbox_img");

    images.forEach(img => {
      img.addEventListener("click", () => {
        lightbox.style.display = "flex";
        lightboxImg.src = img.src;
      });
    });

    window.closeLightbox = function () {
      lightbox.style.display = "none";
      lightboxImg.src = "";
    };
  });
</script>
<!-- 의뢰서 상세 페이지.End-->



  </th:block>
</th:block>